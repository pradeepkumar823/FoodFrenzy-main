<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FoodFrenzy - Buy Product</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
  </head>
  <body>
    <div th:replace="~{Navigation :: navbar}"></div>

    <div class="container animate-fade">
      <!-- Product Order Section -->
      <div
        th:if="${product != null}"
        class="card mb-3"
        style="max-width: 600px; margin: 0 auto"
      >
        <div
          style="
            background: var(--primary);
            color: white;
            padding: 1.5rem;
            text-align: center;
            border-radius: 20px 20px 0 0;
            margin: -2rem -2rem 2rem;
          "
        >
          <i
            class="fa-solid fa-utensils"
            style="font-size: 3rem; margin-bottom: 0.5rem; display: block"
          ></i>
          <h1
            th:text="${product.productName}"
            style="color: white; border: none; margin: 0"
          >
            Product Name
          </h1>
        </div>

        <div class="product-detail p-1">
          <div class="text-center mb-2">
            <p
              class="text-muted"
              th:text="${product.productDescription}"
              style="font-size: 1.1rem"
            >
              Description
            </p>
            <div
              style="
                font-size: 2rem;
                color: var(--primary);
                font-weight: bold;
                margin: 1rem 0;
              "
            >
              ₹<span th:text="${product.productPrice}">0.00</span>
            </div>
          </div>

          <!-- Order Form -->
          <form
            th:action="@{/product/order}"
            method="post"
            th:object="${order}"
            class="mt-2"
          >
            <input
              type="hidden"
              th:field="*{productName}"
              th:value="${product.productName}"
            />
            <input
              type="hidden"
              th:field="*{price}"
              th:value="${product.productPrice}"
            />

            <div class="form-group">
              <label>Quantity</label>
              <div style="display: flex; gap: 1rem">
                <button
                  type="button"
                  class="btn secondary small"
                  onclick="document.getElementById('quantity').stepDown()"
                >
                  -
                </button>
                <input
                  type="number"
                  th:field="*{quantity}"
                  id="quantity"
                  min="1"
                  value="1"
                  required
                  style="text-align: center"
                />
                <button
                  type="button"
                  class="btn secondary small"
                  onclick="document.getElementById('quantity').stepUp()"
                >
                  +
                </button>
              </div>
            </div>

            <button
              type="submit"
              class="btn btn-primary"
              style="width: 100%; margin-top: 1rem"
            >
              <i class="fa-solid fa-bag-shopping"></i> Place Order
            </button>
            <div class="text-center mt-2">
              <a th:href="@{/products}" class="btn secondary small">Cancel</a>
            </div>
          </form>
        </div>
      </div>

      <!-- No Product Found -->
      <div th:if="${message != null}" class="card text-center mb-2">
        <h2 th:text="${message}" style="color: var(--danger)">
          Product Unavailable
        </h2>
        <a th:href="@{/products}" class="btn btn-primary mt-1"
          >Back to Products</a
        >
      </div>

      <!-- User Orders (History) -->
      <div th:if="${orders != null and !orders.isEmpty()}" class="mt-3">
        <h2 class="mb-2">Your Order History</h2>
        <div class="table-container">
          <table class="table">
            <thead>
              <tr>
                <th>Order ID</th>
                <th>Product</th>
                <th>Qty</th>
                <th>Total</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr th:each="order : ${orders}">
                <td th:text="${order.orderId}">#</td>
                <td th:text="${order.productName}">Product</td>
                <td th:text="${order.quantity}">1</td>
                <td style="color: var(--primary); font-weight: bold">
                  ₹<span th:text="${order.totalAmount}">0.00</span>
                </td>
                <td th:text="${order.orderDate}">Date</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <footer class="mt-3">
      <p>
        &copy; 2026 FoodFrenzy. Made with
        <span style="color: var(--primary)">❤️</span> for foodies.
      </p>
    </footer>
  </body>
</html>
